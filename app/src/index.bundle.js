!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=require("electron")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.logPath=void 0;var o=n(9),i=n(0),a=r(n(10)),s=r(n(2)),u=o.format.combine,c=o.format.timestamp,d=o.format.printf,l=s.default.join(i.app.getPath("appData"),"entry-hw","logs"),p=o.createLogger({level:"verbose",format:u(c({format:"YYYY-MM-DD HH:mm:ss"}),d((function(e){var t=e.level,n=e.message;return"["+e.label+"]["+t+"]["+e.timestamp+"]: "+n}))),transports:[new o.transports.Console],exitOnError:!1});p.add(new a.default({level:"info",filename:"entry-hw-%DATE%.log",dirname:l,datePattern:"YYYY-MM-DD",zippedArchive:!0,maxSize:"10m",maxFiles:"14d",json:!1,formatter:function(e){return e.timestamp()+"-production-message:"+(e.message?e.message:"")}})),t.logPath=l,t.default=function(e){return p.child({label:e})}},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("fs")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o,i,a=n(0),s=r(n(2)),u=r(n(11)),c=a.app.getAppPath().indexOf("app.asar")>-1,d=c?s.default.join(a.app.getAppPath(),"app"):s.default.join(a.app.getAppPath(),".."),l=u.default.type().includes("Darwin");t.default={views:s.default.join(d,"src","views"),config:c?s.default.join(d,"..","..","config"):s.default.join(d,"..","config"),server:(o=l?"mac":"win",i=l?"server.txt":"server.exe",c?s.default.join(d,"..","..",i):s.default.join(d,"server",o,i)),validator:c?l?s.default.join(d,"..","..","validator.txt"):s.default.join(d,"..","..","validator.exe"):void 0}},function(e,t){e.exports=require("lodash")},function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=i(n(2)),u=i(n(3)),c=i(n(7)),d=i(n(12)),l=i(n(13)),p=i(n(14)),f=i(n(15)),h=i(n(17)),v=i(n(18)),m=i(n(19)),w=i(n(1)).default("electron/index.ts"),b=void 0,g=null,y=null,_="",O=[];a.app.requestSingleInstanceLock()?(w.info("Entry HW started."),a.app.on("window-all-closed",(function(){a.app.quit()})),a.app.on("open-url",(function(e,t){var n=l.default.getArgsParseData(t).openHardwareId;setTimeout((function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return g?[3,2]:[4,new Promise((function(e){return setTimeout(e,500)}))];case 1:return e.sent(),[3,0];case 2:return g.selectHardware(n),[2]}}))}))}),1e3)})),a.app.on("second-instance",(function(e,t,n){var r={roomId:"",openHardwareId:""},o=t.find((function(e){return e.indexOf("entryhw:")>-1}));if(o&&(r=l.default.getArgsParseData(o)),b&&(w.verbose("[second-instance] mainWindow restored"),b.isMinimized()&&b.restore(),b.focus(),b.webContents&&r)){var i=r.roomId,a=r.openHardwareId;-1===O.indexOf(i)&&(w.info("[second-instance] roomId "+i+" pushed"),O.push(i)),g.addRoomId(i),a&&g.selectHardware(a)}})),a.ipcMain.on("reload",(function(){w.info("Entry HW reload."),y.close(),a.app.relaunch(),a.app.exit(0)})),a.app.commandLine.appendSwitch("enable-experimental-web-platform-features","true"),a.app.commandLine.appendSwitch("disable-renderer-backgrounding"),a.app.commandLine.appendSwitch("enable-web-bluetooth"),a.app.setAsDefaultProtocolClient("entryhw"),a.app.once("ready",(function(){a.Menu.setApplicationMenu(null);var e=process.argv.slice(1),t=p.default(e),n=f.default(t).roomIds;O=n||[];var r=e.indexOf("entryhw:");if(r>-1){var o=l.default.getArgsParseData(e[r]),i=o.roomId,u=o.openHardwareId;i&&(w.info("roomId "+i+" detected"),O.push(i)),u&&(_=u)}d.default.createMainWindow({debug:t.debug}),b=d.default.mainWindow,d.default.createAboutWindow(b),h.default(),y=new c.default,g=new m.default(b,y,{rootAppPath:s.default.join(__dirname,"..","..","..")}),_&&setTimeout((function(){g.selectHardware(_)}),1e3)})),a.ipcMain.on("hardwareForceClose",(function(){d.default.mainWindowCloseConfirmed=!0,null==b||b.close()})),a.ipcMain.on("closeAboutWindow",(function(){d.default.aboutWindow&&d.default.aboutWindow.hide()})),a.ipcMain.on("showMessageBox",(function(e,t){a.dialog.showMessageBoxSync({type:"none",message:t,detail:t})})),a.ipcMain.on("openAboutWindow",(function(){d.default.aboutWindow&&d.default.aboutWindow.show()})),a.ipcMain.handle("checkUpdate",(function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return[4,v.default()];case 1:return[2,e.sent()]}}))}))})),a.ipcMain.handle("getOpenSourceText",(function(){return r(void 0,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=s.default.resolve(__dirname,"..","OPENSOURCE.md"),[4,u.default.promises.readFile(e,"utf8")];case 1:return[2,t.sent()]}}))}))}))):(w.verbose("App is already running"),a.app.quit(),process.exit(0)),process.on("uncaughtException",(function(e){var t=a.dialog.showMessageBoxSync({type:"error",title:"Unexpected Error",message:"Unexpected Error",detail:e.toString(),buttons:["ignore","exit"]});w.error("Entry HW uncaughtException occurred",e.message,e.stack),1===t&&process.exit(-1)}))},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(8)),i=r(n(3)),a=r(n(1)),s=r(n(4)),u=a.default("electron/server"),c=function(){function e(e){try{var t=s.default.server;u.info("EntryServer try to spawn.. "+t),i.default.accessSync(t),this.childProcess=o.default(t,[],{stdio:["ignore","inherit","inherit","ipc"],detached:!0}),u.info("EntryServer spawned successfully"),this.router=e}catch(e){throw u.error("Error occurred while spawn Server Process.",e),new Error("Error occurred while spawn Server Process. make sure it exists same dir path")}}return e.prototype.setRouter=function(e){this.router=e},e.prototype.open=function(){this._receiveFromChildEventRegister(),this._sendToChild("open")},e.prototype.close=function(){this.childProcess&&this.childProcess.kill()},e.prototype.addRoomIdsOnSecondInstance=function(e){this.currentRoomId=e,this._sendToChild("addRoomId",e)},e.prototype.disconnectHardware=function(){this._sendToChild("disconnectHardware")},e.prototype.send=function(e){this._sendToChild("send",e)},e.prototype._sendToChild=function(e,t){this._isProcessLive()&&this.childProcess.send({key:e,value:t})},e.prototype._receiveFromChildEventRegister=function(){var e=this;this.childProcess&&this.childProcess.on("message",(function(t){var n=t.key,r=t.value;switch(n){case"cloudModeChanged":e.router.notifyCloudModeChanged(r);break;case"runningModeChanged":e.router.notifyServerRunningModeChanged(r);break;case"data":e.router.handleServerData(r);break;case"connection":e.router.handleServerSocketConnected();break;case"close":e.currentRoomId&&e.currentRoomId!==r||e.router.handleServerSocketClosed();break;default:console.error("unhandled pkg server message",n,r)}}))},e.prototype._isProcessLive=function(){return this.childProcess&&!this.childProcess.killed&&this.childProcess.connected&&this.childProcess.channel},e}();t.default=c},function(e,t){e.exports=require("cross-spawn")},function(e,t){e.exports=require("winston")},function(e,t){e.exports=require("winston-daily-rotate-file")},function(e,t){e.exports=require("os")},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),i=r(n(2)),a=r(n(1)),s=r(n(4)).default.views,u=a.default("electron/windowManager.ts");t.default=new(function(){function e(){this.mainWindowCloseConfirmed=!1,this.aboutWindow=void 0,this.mainWindow=void 0}return e.prototype.createAboutWindow=function(e){var t=this;u.verbose("about window created"),this.aboutWindow=new o.BrowserWindow({parent:e,width:380,height:290,resizable:!1,movable:!1,center:!0,frame:!1,modal:!0,show:!1,webPreferences:{nodeIntegration:!0,contextIsolation:!1,preload:i.default.join(s,"..","preload","preload.bundle.js")}}),this.aboutWindow.loadURL("file:///"+i.default.resolve(s,"about.html")),this.aboutWindow.on("closed",(function(){t.aboutWindow=void 0}))},e.prototype.createMainWindow=function(e){var t=this,n=e.debug,r=global.sharedObject,a=r.hardwareVersion,c="ko"===r.language?"엔트리 하드웨어 v":"Entry Hardware v";this.mainWindow=new o.BrowserWindow({width:800,height:670,minWidth:420,title:c+a,webPreferences:{backgroundThrottling:!1,nodeIntegration:!1,contextIsolation:!1,preload:i.default.join(s,"..","preload","preload.bundle.js")}}),this.mainWindow.loadURL("file:///"+i.default.resolve(s,"index.html")),n&&this.mainWindow.webContents.openDevTools(),this.mainWindow.setMenu(null),this.mainWindow.on("close",(function(e){var n;t.mainWindowCloseConfirmed||(e.preventDefault(),u.verbose("EntryHW close rejected. confirm connection close"),null===(n=t.mainWindow)||void 0===n||n.webContents.send("hardwareCloseConfirm"))})),this.mainWindow.on("closed",(function(){t.mainWindow=void 0})),u.verbose("main window created. title: "+(c+a))},e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.lpad=function(e,t){var n=e.length,r=e;if(n<t)for(var o=0;o<t-n;o++)r="0"+r;return String(r)},e.prototype.getPaddedVersion=function(e){var t=this;if(!e)return"";var n=String(e),r=[];return n.split(".").forEach((function(e){r.push(t.lpad(e,4))})),r.join(".")},e.prototype.getArgsParseData=function(e){console.log("argv",e);var t=(/roomId:(.*)/.exec(e)||["",""])[1];"undefined"===t&&(t="");var n=(/openHardwareId:([^&]*)/.exec(e)||["",""])[1];return"undefined"===n&&(n=""),{roomId:t.replace(/\//g,""),openHardwareId:n}},e}();t.default=new r},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(1)),i=n(5),a=o.default("ParseCommandLine"),s={flag:[["debug","d"]],pair:[["config","c"],["lang","l"]]},u={};function c(e){for(var t=0;t<s.flag.length;t++){var n=s.flag[t],r=n[0],o=n[1];if("--"+r===e||"-"+o===e)return void(u[r]=!0)}}function d(e,t){if(t)for(var n=0;n<s.pair.length;n++){var r=s.pair[n],o=r[0],i=r[1];if("--"+o===e||"-"+i===e)return void(u[o]=t)}}t.default=function(e){u={};for(var t=0;t<e.length;t++){var n=e[t].split("="),r=n[0],o=n[1];c(r),d(r,o)}return a.info(i.reduce(i.toPairs(u),(function(e,t){return e+"\n"+t[0]+": "+t[1]}),"parsed commandLine config is..")),u}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r(n(16)),i=n(5),a=r(n(2)),s=r(n(3)),u=r(n(1)),c=r(n(4)),d=n(0),l=u.default("ConfigInitialize"),p={updateCheckUrl:"https://playentry.org/api/checkVersion",moduleResourceUrl:"https://playentry.org/modules"},f={appName:"hardware",hardwareVersion:o.default.version,roomIds:[]};function h(e){void 0===e&&(e="entry");var t=a.default.resolve(c.default.config,"config."+e+".json");l.info("load configuration file "+t+"...");var n,r=s.default.readFileSync(t);return n=JSON.parse(r),function(e,t){var n=e;return i.forEach(t,(function(e,t){void 0!==n[t]&&(n[t]=e)})),n}(p,n)}t.default=function(e){var t=e.config,n=void 0===t?"entry":t,r=e.lang,o=h(n),a=(r||o.language||d.app.getLocale()).substr(0,2);"ja"===a&&(a="jp");var s=i.merge({},f,{language:a},o);return l.info("configuration applied"),l.verbose(i.reduce(i.toPairs(s),(function(e,t){return e+"\n"+t[0]+": "+t[1]}),"configuration properties is..")),global&&(global.sharedObject=s),s}},function(e){e.exports=JSON.parse('{"name":"entry-hw","version":"1.9.52","description":"엔트리 하드웨어 연결 프로그램","author":"EntryLabs","main":"./app/src/index.bundle.js","scripts":{"start":"cross-env NODE_ENV=development electron -r source-map-support/register app/src/index.bundle.js --openssl-legacy-provider unset NODE_OPTIONS","start:prod":"cross-env NODE_ENV=production electron -r source-map-support/register app/src/index.bundle.js","debug":"cross-env NODE_ENV=development electron -r source-map-support/register --inspect app/src/index.bundle.js","test":"cross-env NODE_NO_WARNINGS=1 ts-node --files ./cli/connectionTest.ts","script:create":"node ./cli/createJson.js","script:resize":"node cli/imageResize.js","webpack:dev":"cross-env NODE_ENV=development webpack --openssl-legacy-provider","webpack:prod":"cross-env NODE_ENV=production webpack","webpack:watch":"cross-env NODE_ENV=development webpack -w","update:licence":"lcdoc make -o app/OPENSOURCE.md -d 1","dist:win32":"cross-env BUILD_MODE=STANDALONE npm run webpack:prod && electron-builder --win --ia32","dist:mac:notarize":"cross-env BUILD_MODE=STANDALONE npm run webpack:prod && cross-env NOTARIZE=true CSC_NAME=\\"Connect Foundation (DLFUSDA3L5)\\" electron-builder","dist:mac":"cross-env BUILD_MODE=STANDALONE npm run webpack:prod && cross-env NOTARIZE=false CSC_NAME=\\"Connect Foundation (DLFUSDA3L5)\\" electron-builder","dist:offline":"cross-env BUILD_MODE=OFFLINE npm run webpack:prod","rebuild":"electron-rebuild -f -w serialport,node-hid","setting":"yarn rebuild && yarn webpack:dev"},"devDependencies":{"@types/cross-spawn":"^6.0.1","@types/fs-extra":"^8.0.1","@types/inquirer":"^6.5.0","@types/lodash":"^4.14.149","@types/node-hid":"^0.7.3","@types/react":"^16.9.9","@types/react-dom":"^16.9.2","@types/react-redux":"^7.1.5","@types/react-transition-group":"^4.2.3","@types/rimraf":"^2.0.3","@types/semver":"^7.1.0","@types/serialport":"^8.0.0","@types/styled-components":"^4.1.19","@types/tar":"^4.0.3","@types/web-bluetooth":"^0.0.5","@typescript-eslint/eslint-plugin":"^3.1.0","@typescript-eslint/parser":"^3.1.0","babel-eslint":"^10.0.3","clean-webpack-plugin":"^3.0.0","cross-env":"^5.1.3","electron":"12.0.2","electron-builder":"^22.8.0","electron-notarize":"^0.2.1","electron-rebuild":"2.3.5","eslint":"^6.8.0","file-loader":"^5.0.2","immer":"^4.0.2","inquirer":"^7.0.3","lcdoc":"^0.0.2","react":"^16.10.2","react-cli":"^0.3.1","react-dom":"^16.10.2","react-redux":"^7.1.1","react-transition-group":"^4.3.0","redux":"^4.0.4","sharp":"^0.30.1","source-map-support":"^0.5.19","styled-components":"^4.4.0","ts-loader":"^7.0.5","ts-node":"^8.10.2","typescript":"^3.9.5","webpack":"^4.43.0","webpack-cli":"^3.3.11","webpack-merge":"^4.2.2"},"dependencies":{"cross-spawn":"^7.0.0","fs-extra":"^8.1.0","lodash":"^4.17.19","node-hid":"2.1.1","rimraf":"^3.0.2","semver":"^7.1.1","serialport":"9.0.7","socket.io":"^2.2.0","socket.io-client":"^2.2.0","tar":"^6.0.1","winston":"^3.2.1","winston-daily-rotate-file":"^4.4.2"}}')},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(){var e;e="darwin"===process.platform?"Command+Alt+i":"Control+Shift+i",r.globalShortcut.register(e,(function(){var e=r.webContents.getFocusedWebContents();e&&(e.isDevToolsOpened()?e.closeDevTools():e.openDevTools())}))}},function(e,t,n){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(0),a=o(n(1)).default("CheckUpdate");t.default=function(){return new Promise((function(e,t){var n=global.sharedObject,o=n.updateCheckUrl,s=n.hardwareVersion,u=i.net.request({method:"POST",url:o}),c={category:"hardware",version:s};u.setHeader("content-type","application/json; charset=utf-8"),u.write(JSON.stringify(c)),a.info("entry hw version check.. "+JSON.stringify(r({url:o,method:"POST",contentType:"application/json; charset=utf-8"},c))),u.on("response",(function(n){var r="";n.on("error",t),n.on("data",(function(e){r+=e.toString()})),n.on("end",(function(){var t={};try{(t=JSON.parse(r)).currentVersion=s,a.info("result: "+JSON.stringify(t))}catch(e){}finally{e(t)}}))})),u.on("error",t),u.end()}))}},function(e,t){e.exports=require("./main/mainRouter.build")}]);
//# sourceMappingURL=index.bundle.js.map